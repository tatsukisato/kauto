# データ詳細

## データセット概要

### 学習データ (train_meta.csv)

- **総件数**: 24,920件
- **クオーター構成**:
  - Q1: 6,410件
  - Q2: 18,510件
- **画像形式**: 完全な試合画像
- **画角**: side（横）とtop（上）の両方
- **bbox精度**: 過不足のない完全なbbox

#### カラム構成

| カラム名 | 型 | 説明 | 例 |
|---------|-----|------|-----|
| quarter | string | クオーター番号 | Q1-000, Q2-015 |
| angle | string | 画角 (side/top) | side |
| session | int | セッション番号（常に0） | 0 |
| frame | int | フレーム番号 | 1-50 |
| x | int | bbox左上X座標 (px) | 1526 |
| y | int | bbox左上Y座標 (px) | 961 |
| w | int | bbox幅 (px) | 60 |
| h | int | bbox高さ (px) | 151 |
| label_id | int | 選手ID (0-10) | 0-10 |

### テストデータ (test_meta.csv)

- **総件数**: 未定（`test_meta.csv`を確認）
- **クオーター構成**: Q4のみ
- **画像形式**: ⚠️ **bbox領域を切り抜いた画像（crop画像）**
- **画角**: ⚠️ **上・横どちらか一方のみの場合がある**
- **bbox精度**: ⚠️ **常に正しいとは限らない**（数が多すぎる/少なすぎるケースあり）
- **注意**: label_idカラムは存在しない（予測対象）

#### カラム構成

| カラム名 | 型 | 説明 | 例 |
|---------|-----|------|-----|
| quarter | string | クオーター番号 | Q4-000 |
| angle | string | 画角 (side/top) | side |
| session | int | セッション番号 | 0-3 |
| frame | int | フレーム番号 | 1-50 |
| x | int | bbox左上X座標 (px) | 1526 |
| y | int | bbox左上Y座標 (px) | 961 |
| w | int | bbox幅 (px) | 60 |
| h | int | bbox高さ (px) | 151 |
| **rel_path** | string | **切り抜き画像のパス** | crop/Q4-000_side_00_01_0.jpg |

> ⚠️ **重要**: テストデータでは完全画像ではなく、`rel_path`で指定される切り抜き画像を使用します

### 学習データとテストデータの重要な違い

| 項目 | 学習データ | テストデータ |
|------|-----------|-------------|
| **画像形式** | 完全な試合画像 | bbox切り抜き画像（crop） |
| **画角** | side + top（両方） | side または top（片方のみの場合あり） |
| **bbox精度** | 完全（過不足なし） | 不完全（多すぎる/少なすぎる場合あり） |
| **クオーター** | Q1, Q2 | Q4 |
| **session** | 常に0 | 0-3（複数の値） |
| **label_id** | あり | なし（予測対象） |
| **画像パス** | ファイル名から構築 | `rel_path`カラムで指定 |

### bbox精度の問題（テストデータのみ）

テストデータでは以下の問題が発生する可能性があります:

1. **誤検出（False Positive）**: 選手でないものがbboxとして検出される
2. **検出漏れ（False Negative）**: 選手がbboxとして検出されない
3. **bbox数の不一致**: 実際の選手数とbbox数が一致しない

**対応策**: 選手とみなせないbboxには `-1` (unknown) を予測する

### bboxの重なり

同一フレーム内で複数のbboxが重なっているケースがあります。

- **同一選手の重複bbox**: 両方のbboxに同じ選手IDを出力
- **異なる選手の重なり**: それぞれのbboxに対応する選手IDを出力



- **総件数**: 1,480件
- **内容**: テストデータの一部セッションのtop画角データ
- **用途**: 補助情報として利用可能

### 画像データ

- **保存場所**: `data/raw/images/`
- **命名規則**: `{quarter}__{angle}__{session}__{frame}.jpg`
  - 例: `Q1-000__side__00__01.jpg`
- **画像サイズ**: 約1.3MB/枚
- **総容量**: 約4.5GB

## クラス分布

### 学習データ

| Label ID | Q1での出現数 | Q2での出現数 | 合計 |
|----------|-------------|-------------|------|
| 0 | 642 | 0 | 642 |
| 1 | 642 | 1,853 | 2,495 |
| 2 | 642 | 1,853 | 2,495 |
| 3 | 642 | 1,853 | 2,495 |
| 4 | 642 | 1,853 | 2,495 |
| 5 | 0 | 1,853 | 1,853 |
| 6 | 638 | 1,842 | 2,480 |
| 7 | 642 | 1,853 | 2,495 |
| 8 | 642 | 1,853 | 2,495 |
| 9 | 637 | 1,853 | 2,490 |
| 10 | 642 | 1,843 | 2,485 |

### 重要な観察

1. **選手の入れ替え**: 
   - Player 0はQ1のみに登場
   - Player 5はQ2のみに登場
   
2. **クラス不均衡**: 
   - Player 0とPlayer 5は他の選手の約1/3の出現数
   
3. **テストデータの未知性**: 
   - テストデータ(Q4)に学習データにない選手が登場する可能性
   - その場合は`-1` (unknown)を予測する必要がある

## ファイル名の命名規則

### 画像ファイル

```
{クオーター番号}__{画角}__{セッション番号}__{フレーム番号}.jpg
```

- **クオーター番号**: `Q1-000`, `Q2-015`, `Q4-019` など
- **画角**: `side` (横から) または `top` (上から)
- **セッション番号**: `00`, `01`, `02`, `03` (2桁ゼロパディング)
- **フレーム番号**: `01`, `02`, ..., `50` (2桁ゼロパディング)

### 例

```
Q1-000__side__00__01.jpg  # Q1-000クオーター、横から、セッション0、フレーム1
Q2-015__top__02__25.jpg   # Q2-015クオーター、上から、セッション2、フレーム25
```

## データの特徴

### 時系列性

- クオーター番号が増えるほど試合が進行
- セッション番号が増えるほどクオーター内で時間が経過
- フレーム番号が増えるほどセッション内で時間が経過

### 画角の違い

- **side (横から)**: 
  - 選手の横顔や背番号が見える
  - 学習・テストデータ両方に存在
  
- **top (上から)**: 
  - 選手の頭頂部や位置関係が見える
  - 学習データのみに存在（テストは一部のみ補助データとして提供）

## データ取得

画像データは以下からダウンロード:
- [Google Drive](https://drive.google.com/file/d/1YXbi2O6-PIaQ3amm3-tkuWJhk1OObjtf/view?usp=drive_link)

メタデータは`data/raw/`に配置済み。
