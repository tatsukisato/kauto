# #22 CA x atmaCup 3rd - バスケットボール選手判別チャレンジ

## 概要

このコンペティションのゴールは、バスケットボールの試合動画から切り出された静止画に対し、**特定のバウンディングボックス（bbox）に写っている選手が誰であるか**を正確に識別することです。

具体的には、画像と選手の位置（bbox）が与えられるので、その位置にいる選手のID（ラベル）を予測していただきます。

## タスク

### 入力
- **学習データ**: バスケットボールの試合の完全画像 + bbox位置情報 + 選手ID
- **テストデータ**: bbox領域を切り抜いた画像（crop画像）

### 出力
- そのbboxに写っている選手のID（0-10）
- 学習データに存在しない選手、または選手とみなせないbboxの場合は `-1` (unknown)

### データ構成

- **学習データ**: 
  - Q1とQ2のクオーターの**完全画像**とbboxアノテーション
  - 各画像に「どこに」「誰が」写っているかの情報が含まれる
  - 横（side）と上（top）の**両方の画角**が提供される
  - bboxは**過不足のない完全なもの**

- **テストデータ**: 
  - Q4のクオーターの**bbox切り抜き画像**（crop画像）
  - 「誰が」写っているかを予測する（label_idなし）
  - 画角は**上・横どちらか一方のみ**の場合がある
  - bboxは**常に正しいとは限らない**（数が多すぎる/少なすぎるケースあり）

> 📊 **データの詳細は [DATA.md](DATA.md) を参照してください**

## 重要な注意事項

### 1. 学習/テストデータのシフト

#### 画像形式の違い
- **学習データ**: 完全な試合画像が提供される
- **テストデータ**: bbox領域を切り抜いた画像のみ（完全画像は提供されない）

#### 画角の違い
- **学習データ**: 同じシーンを上（top）と横（side）の両方から撮影
- **テストデータ**: 上・横どちらか一方のみの場合がある

### 2. bboxの精度問題

- **学習データ**: 過不足のない完全なbboxが提供される
- **テストデータ**: bboxが常に正しいとは限らない
  - bboxの数が**多すぎる**ケース（誤検出）
  - bboxの数が**少なすぎる**ケース（検出漏れ）
  - 選手とみなせないbboxが含まれる可能性

### 3. 選手の入れ替え

試合途中に選手の入れ替えが発生しています（タイミングは非公開）。

**対応**: 学習データに存在しない選手、または選手とみなせないbboxの場合は **`-1`** (unknown) を出力

### 4. bboxの重なり

同一フレーム内でbboxが重なっているケースがあります。

**対応**: 重なっている2つのbboxが同一の選手を示す場合、**どちらのbboxにも対象の選手のIDを出力**してください

### 5. 時系列性

- 学習データ: Q1, Q2
- テストデータ: Q4

学習データとテストデータで時間的な隔たりがあるため、選手の構成が異なる可能性があります。

## 評価指標

**Macro F1スコア**で評価を行います。

各選手クラス（0-10および`-1`）ごとにF1スコアを計算し、その平均を取ります。

$$
\text{Macro F1} = \frac{1}{N} \sum_{i=1}^{N} F1_i
$$

ここで、$N$はクラス数、$F1_i$は各クラスのF1スコアです。

## 提出フォーマット

- ファイル形式: CSV
- ヘッダー: なし
- カラム: `label_id` のみ（1列）
- 行数: `test_meta.csv`と同じ行数
- 値の範囲: -1 ~ 10

例:
```
7
3
1
-1
...
```

## 戦略上の考慮点

### 学習データとテストデータのギャップ

1. **画像形式の違い**: 完全画像 vs 切り抜き画像
   - 学習時にbbox領域のみを使用する戦略が有効
   
2. **画角の違い**: 両方 vs 片方のみ
   - 片方の画角のみでも識別できるモデルが必要
   
3. **bboxの精度**: 完全 vs 不完全
   - 誤検出・検出漏れに対するロバスト性が必要
   - `-1`（unknown）の予測戦略が重要

## リンク

- **データ詳細**: [DATA.md](DATA.md)
- **実験ログ**: [EXPERIMENTS.md](EXPERIMENTS.md)
- **学んだこと**: [LESSONS_LEARNED.md](LESSONS_LEARNED.md)
- **画像データダウンロード**: [Google Drive](https://drive.google.com/file/d/1YXbi2O6-PIaQ3amm3-tkuWJhk1OObjtf/view?usp=drive_link)